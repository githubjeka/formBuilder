/*
formBuilder - http://kevinchappell.github.io/formBuilder/
Version: 1.3.0
Author: Kevin Chappell <kevin.b.chappell@gmail.com>
*/
"use strict";function FBUtil(e){var t={doCancel:!1},r=$(document.getElementById(e.formID));return t.makeID=function(e){var t=(new Date).getTime();return e+"-"+t},t.uniqueArray=function(e){return e.filter(function(e,t,r){return r.indexOf(e)===t})},t.startDrag=function(e,r){e=e,r.item.addClass("moving"),t.startIndex=$("li",this).index(r.item)},t.stopDrag=function(e,r){e=e,r.item.removeClass("moving"),t.doCancel&&($(r.sender).sortable("cancel"),$(this).sortable("cancel"))},t.safename=function(e){return e.replace(/\s/g,"-").replace(/[^a-zA-Z0-9\-]/g,"").toLowerCase()},t.forceNumber=function(e){return e.replace(/[^0-9]/g,"")},t.initTooltip=function(e){var t=e.find(".tooltip");e.mouseenter(function(){t.outerWidth()>200&&t.addClass("max-width"),t.css("left",e.width()+14),t.stop(!0,!0).fadeIn("fast")}).mouseleave(function(){e.find(".tooltip").stop(!0,!0).fadeOut("fast")}),t.hide()},t.save=function(){r.children("li.form-field").not(".disabled");"xml"===e.dataType&&elem.val(r.toXML())},t.updatePreview=function(e){var t;$(".prev-holder",e).html(t)},t.nameAttr=function(e){var t=(new Date).getTime();return e+"-"+t},t.htmlEncode=function(e){return $("<div/>").text(e).html()},t.htmlDecode=function(e){return $("<div/>").html(e).text()},t.validateForm=function(){var t=[];$('input[name="label"], input[type="text"].option',r).each(function(){if(""===$(this).val()){var r=$(this).parents("li.form-field"),a=$(this);t.push({field:r,error:e.labels.labelEmpty,attribute:a})}}),t.length&&(alert("Error: "+t[0].error),$("html, body").animate({scrollTop:t[0].field.offset().top},1e3,function(){var e=$(".toggle-form",t[0].field).attr("id");$(".toggle-form",t[0].field).addClass("open").parent().next(".prev-holder").slideUp(250),$(document.getElementById(e+"-fld")).slideDown(250,function(){t[0].attribute.addClass("error")})}))},t.disabledTT=function(e){var t=e.attr("data-tooltip");if(t){e.removeAttr("title").data("tip_text",t);var r=$("<p/>",{"class":"frmb-tt"}).html(t);e.append(r),r.css({top:-r.outerHeight(),left:-15}),e.mouseleave(function(){$(this).attr("data-tooltip",e.data("tip_text")),$(".frmb-tt").remove()})}},String.prototype.toCamelCase=function(){return this.replace(/(\-\w)/g,function(e){return e[1].toUpperCase()})},t.markup=function(e){var r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],a=arguments.length<=2||void 0===arguments[2]?"":arguments[2];r=t.attrString(r),a=Array.isArray(a)?a.join(""):a;var n=["input"],o=-1===n.indexOf(e)?"<"+e+" "+r+">"+a+"</"+e+">":"<"+e+" "+r+"/>";return o},t.attrString=function(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(r+'="'+e[r]+'"');return t.join(" ")},t.removeField=function(e){e.slideUp(250,function(){$(this).remove(),t.save()})},t}function Fields(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=document.createElement(e);for(var a in t)t.hasOwnProperty(a)&&(r[a]=a);return r}function Field(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=(arguments.length<=2||void 0===arguments[2]?{}:arguments[2],document.createElement(e));for(var a in t)t.hasOwnProperty(a)&&r.setAttribute(a,t[a]);return r}function Controls(e){var t=document.createElement("div");return t.className="fb-control-wrapper col-md-4",e.fields.map(function(r,a){var n=new Field("button",{"class":""+e.prefix+r.attrs.type+"-control fb-control",type:"button"}),o=document.createTextNode(r.meta.label);return n.appendChild(o),t.appendChild(n),n}),t}var FormBuilder=function(e,t){var r=this,a={prefix:"fb-",dataType:"json",disableFields:{},roles:[{value:1,label:"Administrator"}],saveUrl:!1,showWarning:!1,serializePrefix:"frmb",labels:{add:"Add Item",allowSelect:"Allow Select",autocomplete:"Autocomplete",cannotBeEmpty:"This field cannot be empty",checkboxGroup:"Checkbox Group",checkbox:"Checkbox",checkboxes:"Checkboxes","class":"Class",clearAllMessage:"Are you sure you want to remove all items?",clearAll:"Clear All",close:"Close",copy:"Copy To Clipboard",date:"Date Field",description:"Help Text",descriptionField:"Description",devMode:"Developer Mode",disableFields:"These fields cannot be moved.",editNames:"Edit Names",editXML:"Edit XML",fieldRemoveWarning:"Are you sure you want to remove this field?",getStarted:"Drag a field from the right to this area",hide:"Edit",id:"ID",label:"Label",labelEmpty:"Field Label cannot be empty",limitRole:"Limit access to one or more of the following roles:",mandatory:"Mandatory",maxLength:"Max Length",minOptionMessage:"This field requires a minimum of 2 options",name:"Name",no:"No",off:"Off",on:"On",optional:"optional",options:"Options",optionLabelPlaceholder:"Label",optionValuePlaceholder:"Value",optionEmpty:"Option value required",paragraph:"Paragraph",preview:"Preview",radioGroup:"Radio Group",radio:"Radio",removeMessage:"Remove Element",remove:"&#215;",required:"Required",roles:"Limit Access",save:"Save Template",selectOptions:"Select Items",select:"Select",selectionsMessage:"Allow Multiple Selections",text:"Text Field",textarea:"Text Area",warning:"Warning!",viewXML:"View XML",yes:"Yes"}},n=Object.assign(a,t),o=new FBUtil(n);r.id=o.makeID("form-builder"),n.fields=function(){var e=["text","textarea","select"];return e.map(function(e,t){var r={meta:{label:n.labels[e]},attrs:{type:e}};return r})}(),r.init=function(e){var t=document.createElement("div");t.setAttribute("id",r.id),t.setAttribute("class","form-builder"),r.controls=new Controls(n),r.stage=document.createElement("div"),r.stage.setAttribute("class","fb-stage"),r.stage.setAttribute("id",o.makeID(r.stage.className)),r.stage.setAttribute("class",r.stage.className+" col-md-8"),t.appendChild(r.controls),t.appendChild(r.stage),e.parentElement.replaceChild(t,e)}(e)};!function(e){e.fn.formBuilder=function(t){var r=this;return r.each(function(){var r=this,a=new FormBuilder(r,t);e(a).data("formBuilder")||e(a).data("formBuilder",a)})}}(jQuery);